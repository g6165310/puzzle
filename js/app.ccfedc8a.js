(function(t){function e(e){for(var o,s,u=e[0],a=e[1],c=e[2],p=0,f=[];p<u.length;p++)s=u[p],i[s]&&f.push(i[s][0]),i[s]=0;for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[o]=a[o]);l&&l(e);while(f.length)f.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,u=1;u<n.length;u++){var a=n[u];0!==i[a]&&(o=!1)}o&&(r.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},i={app:0},r=[];function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/puzzle/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],a=u.push.bind(u);u.push=e,u=u.slice();for(var c=0;c<u.length;c++)e(u[c]);var l=a;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"2ba5":function(t,e,n){t.exports=n.p+"img/img-Qingming.a0dca663.png"},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var o=n("2b0e"),i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("section",{directives:[{name:"show",rawName:"v-show",value:!t.isCompelete,expression:"!isCompelete"}],key:"game",staticClass:"game"},[o("div",{staticClass:"title"},[t._v("請完成這幅《清明上河圖》")]),t._l(t.puzzles,function(e,n){return o("div",{key:n,staticClass:"puzzle",class:{isSelected:-1!=t.currentCombination.indexOf(n)},style:{top:e.top+"px",left:e.left+"px"},attrs:{"data-index":n},on:{mousedown:function(e){return t.mousedownHandler(e,n)},mouseup:function(e){return t.checkNeighbors(e,t.currentCombination)}}},[o("img",{ref:"img",refInFor:!0,attrs:{src:"./img/Puzzle-"+e.srcIdx+".png"}})])}),o("div",{staticClass:"btn-reset",on:{click:function(e){return t.reset()}}},[t._v("重新排列")])],2),t.isCompelete?o("section",{key:"result",staticClass:"result"},[o("img",{attrs:{src:n("2ba5"),alt:""}}),o("div",{staticClass:"content"},[o("h2",[t._v("清院本清明上河圖")]),o("h5",[t._v("陳枚、孫祜、金昆、戴洪、程志道")]),o("span",[t._v("清高宗乾隆元年（1736）")]),o("p",[t._v("宋張澤端（活動於西元十二世紀前期）「清明上河圖」是畫史中寫實風俗畫的一件傑作，歷代臨仿者甚多，在故宮即藏有七種不同的本子，其中就屬清院本「清明上河圖」最為有名。")]),o("p",[t._v("此卷為乾隆元年（一七三六）由宮廷畫院畫師陳枚、孫祜、金昆、戴洪、程志道等五人合繪。 此卷設色鮮麗，用筆圓熟，界畫橋樑、屋宇及人物皆十分細膩嚴謹，是院畫中之極精者。所畫事物甚多，雖失去了宋代古制，但也足以代表明清之際北京風物。")]),o("div",{staticClass:"restart-btn",on:{click:function(e){return t.reset()}}},[t._v("再玩一次")])])]):t._e()])},r=[],s=n("75fc"),u=(n("ac6a"),n("b6d0")),a=n.n(u),c=n("2f62"),l=n("5118"),p={name:"app",data:function(){return{col:3,row:3,puzzles:[],currentIdx:null,startX:0,startY:0,combinations:[],currentCombination:[],isCompelete:!1}},computed:{},methods:{init:function(){for(var t=this.col*this.row,e=document.documentElement.clientWidth,n=document.documentElement.clientHeight,o=this.col,i=this,r=0;r<t;r++){var s=100+(n-380)*Math.random(),u=100+(e-380)*Math.random(),a=i.setNeighbors(r,o,t);i.puzzles.push({index:r,srcIdx:r+1,top:s,left:u,neighbors:a})}},setNeighbors:function(t,e,n){var o=[];switch(t%3){case 0:o=[t-e,t+1,t+e];break;case e-1:o=[t-e,t-1,t+e];break;default:o=[t-e,t-1,t+1,t+e]}return o=o.filter(function(t){return t>=0&&t<n}),o},adjustImg:function(){for(var t=this.$el.querySelectorAll(".puzzle img"),e=0;e<t.length;e++){var n=t[e].naturalHeight,o=t[e].naturalWidth;o>180&&e%3!=0&&(t[e].style.left="-27px"),n>180&&e>this.col-1&&(t[e].style.top="-27px")}},mousedownHandler:function(t,e){t.stopPropagation(),this.currentIdx=e,this.startX=t.clientX,this.startY=t.clientY,this.currentCombination=this.setCurrentCombination(),document.onmousemove=this.move},move:function(t){t.stopPropagation(),t.preventDefault();var e=this,n=t.clientX-this.startX,o=t.clientY-this.startY;this.startX=t.clientX,this.startY=t.clientY;this.startX,this.puzzles[this.currentIdx].left,this.startY,this.puzzles[this.currentIdx].top;for(var i=!0,r=0;r<e.currentCombination.length;r++)if(!e.checkInWindow(e.puzzles[e.currentCombination[r]].top+o,e.puzzles[e.currentCombination[r]].left+n)){i=!1;break}if(i)for(var s=0;s<e.currentCombination.length;s++)e.puzzles[e.currentCombination[s]].top=e.puzzles[e.currentCombination[s]].top+o,e.puzzles[e.currentCombination[s]].left=e.puzzles[e.currentCombination[s]].left+n;else document.onmousemove=null,e.currentCombination=[];document.onmouseup=function(){document.onmousemove=null}},setCombination:function(t,e){var n,o,i,r=new a.a,u=this;(u.combinations.forEach(function(i){i.has(e)&&(o=i),i.has(t)&&(n=i)}),o===n&&o)||(o&&n&&((i=o).add.apply(i,Object(s["a"])(n)),u.combinations.splice(u.combinations.indexOf(n),1)),o?o.add(t):n?n.add(e):(r.add(t).add(e),u.combinations.push(r)))},setCurrentCombination:function(){for(var t=this,e=0;e<t.combinations.length;e++)if(t.combinations[e].has(t.currentIdx))return Object(s["a"])(t.combinations[e]);return[t.currentIdx]},checkInWindow:function(t,e){var n=document.documentElement.clientWidth,o=document.documentElement.clientHeight;return t>100&&t<o-280&&e>100&&e<n-280?1:0},checkNeighbors:function(t){var e=this;e.currentCombination.forEach(function(t){for(var n=e.puzzles[t].neighbors,o=function(o){var i=e.puzzles[t].top,r=e.puzzles[t].left,s=e.puzzles[n[o]].top,u=e.puzzles[n[o]].left,a=0,c=0,l=!0;switch(!0){case t-n[o]==-1&&Math.abs(i-s)<10&&Math.abs(r-u)-180<10:a=u-180-r,c=s-i;break;case t-n[o]==1&&Math.abs(i-s)<10&&Math.abs(r-u)-180<10:a=u+180-r,c=s-i;break;case t-n[o]==-3&&Math.abs(i-s)-180<10&&Math.abs(r-u)<10:a=u-r,c=s-180-i;break;case t-n[o]==3&&Math.abs(i-s)-180<10&&Math.abs(r-u)<10:a=u-r,c=s+180-i;break;default:l=!1}l&&(e.currentCombination.forEach(function(t){e.puzzles[t].top=e.puzzles[t].top+c,e.puzzles[t].left=e.puzzles[t].left+a}),e.setCombination(t,n[o]))},i=0;i<n.length;i++)o(i)}),document.onmouseup=function(){document.onmousemove=null,e.currentCombination=[]},e.checkCompelete()},checkCompelete:function(){var t=this;0!=t.combinations.length&&9===t.combinations[0].size&&(t.isCompelete=!0)},reset:function(){this.puzzles=[],this.combinations=[],this.isCompelete=!1,this.showContent=!1,this.init()}},mounted:function(){var t=this;Object(l["setTimeout"])(function(){t.adjustImg()},100)},created:function(){this.init()}},f=p,m=(n("5c0b"),n("2877")),h=Object(m["a"])(f,i,r,!1,null,null,null),d=h.exports;o["a"].use(c["a"]);var b=new c["a"].Store({state:{puzzleCol:3,puzzleRow:3,puzzles:[]},mutations:{INITPOS:function(t,e){t.puzzles.push(e),t.puzzles[e.index].combition=[]},NEIGHBORS:function(t,e){t.puzzles[e.index].neighbor=e.data},NEWPOS:function(t,e){t.puzzles[e.index].top=e.top,t.puzzles[e.index].left=e.left},COMBITION:function(t,e){t.puzzles[e.index].combition.push(e.combineId)},IMGINFO:function(t,e){t.puzzles[e.index].width=e.width,t.puzzles[e.index].height=e.height},RESET:function(t){t.puzzles=[]}},actions:{setInitPos:function(t,e){t.commit("INITPOS",e)},setNeighbors:function(t,e){t.commit("NEIGHBORS",e)},setImgInfo:function(t,e){t.commit("IMGINFO",e)},updatePos:function(t,e){t.commit("NEWPOS",e)},updateCombination:function(t,e){t.commit("COMBITION",e)}},getters:{puzzles:function(t){return t.puzzles},puzzleCol:function(t){return t.puzzleCol},puzzleRow:function(t){return t.puzzleRow}}});o["a"].config.productionTip=!1,new o["a"]({store:b,render:function(t){return t(d)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var o=n("5e27"),i=n.n(o);i.a},"5e27":function(t,e,n){}});
//# sourceMappingURL=app.ccfedc8a.js.map